<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · ModelOrderReductionToolkit.jl</title><meta name="title" content="Docstrings · ModelOrderReductionToolkit.jl"/><meta property="og:title" content="Docstrings · ModelOrderReductionToolkit.jl"/><meta property="twitter:title" content="Docstrings · ModelOrderReductionToolkit.jl"/><meta name="description" content="Documentation for ModelOrderReductionToolkit.jl."/><meta property="og:description" content="Documentation for ModelOrderReductionToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelOrderReductionToolkit.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">ModelOrderReductionToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Docstrings</a></li><li><a class="tocitem" href="test_prob.html">Test Problem</a></li><li><a class="tocitem" href="rbm_tutorial.html">RBM Tutorial</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ModelOrderReductionToolkit.jl-Docstrings"><a class="docs-heading-anchor" href="#ModelOrderReductionToolkit.jl-Docstrings">ModelOrderReductionToolkit.jl Docstrings</a><a id="ModelOrderReductionToolkit.jl-Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#ModelOrderReductionToolkit.jl-Docstrings" title="Permalink"></a></h1><h3 id="Affinely-parameter-dependent-arrays:"><a class="docs-heading-anchor" href="#Affinely-parameter-dependent-arrays:">Affinely parameter-dependent arrays:</a><a id="Affinely-parameter-dependent-arrays:-1"></a><a class="docs-heading-anchor-permalink" href="#Affinely-parameter-dependent-arrays:" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.APArray" href="#ModelOrderReductionToolkit.APArray"><code>ModelOrderReductionToolkit.APArray</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>AffineParametrizedArray(arrays, makeθi[, precompθ=false])</code></p><p>Struct for containing an affine parametrized array <code>A(p)</code> of the form <code>A(p) = ∑ makeθi(p,i) * arrays[i]</code>.</p><p>Arrays are stored in the vector <code>arrays</code> for quick recomputation for new parameter values. Each must be of the same size and dimension so that they can be  broadcast summed.</p><p>If precompθ set to <code>false</code> (default):</p><p>The function <code>makeθi(p,i)</code> takes in a parameter object first, and second an index <code>i=1,...,length(arrays)</code>, and returns a scalar</p><p>If <code>precompθ</code> set to <code>true</code>:</p><p>The function <code>makeθi(p)</code> takes in a parameter object, and returns a vector of each of the affine terms.</p><p>Given <code>aparr &lt;: AffineParametrizedArray</code>, and a new parameter value <code>p</code>,  can form the full array <code>A(p)</code> by calling <code>aparr(p)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/ap_arrays.jl#L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.formArray!" href="#ModelOrderReductionToolkit.formArray!"><code>ModelOrderReductionToolkit.formArray!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>formArray!(aparr, arr, p)</code></p><p>Given an array <code>arr</code> with the same dimensions as the arrays in the APArray <code>aparr</code>, form <code>A(p)</code> and place its values in <code>arr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/ap_arrays.jl#L43-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.eim" href="#ModelOrderReductionToolkit.eim"><code>ModelOrderReductionToolkit.eim</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>eim(arrFun, param_disc[, ϵ=1e-2; maxM=100, noise=1])</code></p><p>Method for constructing an <code>APArray</code> object from a non-affinely parameter dependent matrix <code>arrFun(p)</code> by empirical interpolation. </p><p><code>param_disc</code> must be a matrix with columns as parameter vectors, or a vector with elements as parameters.</p><p>Loops over the given parameter discretization until a maximum ∞-norm error  of <code>ϵ</code> is achieved over the entire discretization, or until the maximum number of parameter values are chosen, given by <code>maxM</code>.</p><p><code>noise</code> dictates the amount of printed output. Set <code>0</code> for no output, <code>1</code> for some output, <code>≥2</code> for most.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/ap_arrays.jl#L70-L85">source</a></section></article><h3 id="Matrices-as-vector-of-vectors:"><a class="docs-heading-anchor" href="#Matrices-as-vector-of-vectors:">Matrices as vector of vectors:</a><a id="Matrices-as-vector-of-vectors:-1"></a><a class="docs-heading-anchor-permalink" href="#Matrices-as-vector-of-vectors:" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.VOV" href="#ModelOrderReductionToolkit.VOV"><code>ModelOrderReductionToolkit.VOV</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>VectorOfVectors{T} &lt;: AbstractMatrix{T}</code></p><p>Type for defining matrices as vectors of vectors for  quick insertion of rows and columns. Stores the columns as vectors in <code>vecs</code> and its size in <code>size</code>.</p><p>Construct an empty <code>VOV</code> of dimensions <code>(nrows × ncols)</code> where  one of <code>nrows</code> or <code>ncols</code> must be zero:</p><p><code>VectorOfVectors(nrows=0, ncols=0, T=Float64)</code></p><p>Construct a <code>VOV</code> from a Julia vector of vectors:</p><p><code>VectorOfVectors(vecs::AbstractVector{&lt;:AbstractVector{T}})</code></p><p>Construct a <code>VOV</code> from a matrix:</p><p><code>VectorOfVectors(M::AbstractMatrix{T})</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.addRow!" href="#ModelOrderReductionToolkit.addRow!"><code>ModelOrderReductionToolkit.addRow!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>addRow!(vov::VectorOfVectors)</code></p><p>Add a row to the vector of vectors by appending <code>zero(T)</code> to each vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L77-L82">source</a></section><section><div><p><code>addRow!(vov::VectorOfVectors, row::AbstractVector)</code></p><p>Add the vector <code>row</code> to the last column of <code>vov</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L90-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.removeRow!" href="#ModelOrderReductionToolkit.removeRow!"><code>ModelOrderReductionToolkit.removeRow!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>removeRow!(vov::VectorOfVectors)</code></p><p>Remove a row from the vector of vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.addCol!" href="#ModelOrderReductionToolkit.addCol!"><code>ModelOrderReductionToolkit.addCol!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>addCol!(vov::VectorOfVectors)</code></p><p>Add a column to the vector of vectors by appending <code>zeros(T,nrow)</code> to <code>vov.vecs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L119-L124">source</a></section><section><div><p><code>addCol!(vov::VectorOfVectors, col::AbstractVector)</code></p><p>Add the vector <code>row</code> to the last column of <code>vov</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.removeCol!" href="#ModelOrderReductionToolkit.removeCol!"><code>ModelOrderReductionToolkit.removeCol!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>removeCol!(vov::VectorOfVectors)</code></p><p>Remove a column from the vector of vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/vector_of_vectors.jl#L147-L151">source</a></section></article><h3 id="Projections-functionality:"><a class="docs-heading-anchor" href="#Projections-functionality:">Projections functionality:</a><a id="Projections-functionality:-1"></a><a class="docs-heading-anchor-permalink" href="#Projections-functionality:" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.singular_values_information" href="#ModelOrderReductionToolkit.singular_values_information"><code>ModelOrderReductionToolkit.singular_values_information</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>singular_values_information(σs)</code></p><p>Given a vector of real singular values <code>σs</code>, return a vector providing the maximum percentage of &quot;information&quot; available from a <code>d</code>-dimensional representation in Frobenius norm.</p><p>Uses the fact that the maximum error in projecting onto the first <code>d</code> left singular vectors is given by</p><p><code>||A-A_d||_F = √ (σ_{d+1}^2 + ... + σ_N^2)</code>.</p><p>So the information with a <code>d</code>-dimensional representation given by</p><p><code>singular_values_information[d] = 1 - √ (σ_{d+1}^2 + ... + σ_N^2) / √ (σ_1^2 + ... + σ_N^2)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/projections.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.pca_projector" href="#ModelOrderReductionToolkit.pca_projector"><code>ModelOrderReductionToolkit.pca_projector</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>P = pca_projector(A, dim=-1; info_tol=1e-2)</code></p><p>Uses the first dim singular vectors of <code>A</code> to generate an orthogonal projection operator <code>P</code>. Operator performs matrix operation and can be done on vectors or matrices of proper dimension.</p><p>If <code>dim</code> is not provided, uses <code>n</code> singular values  where <code>n</code> is the smallest integer such that the amount of information per the Frobenious norm is at least <code>1-info_tol</code>.</p><p>Returns a functor <code>P</code> which stores the reduced dimension <code>n</code>, the dimension of vectors to project <code>m</code>, the singular values of <code>A</code> in <code>s</code>, and the vectors to project onto in the <code>m × n</code> matrix <code>M</code>.</p><p>Call with <code>P(b)</code> where <code>b</code> is a <code>m</code> vector or a matrix with <code>m</code> rows, projecting each column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/projections.jl#L30-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.qr_projector" href="#ModelOrderReductionToolkit.qr_projector"><code>ModelOrderReductionToolkit.qr_projector</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>qr_projector(A, dim)</code></p><p>Uses the first <code>dim</code> columns of <code>A</code> by qr-pivot order (norm) to generate an orthogonal projection operator <code>P</code>. Operator performs matrix operation and can be done on vectors or matrices of proper dimension.</p><p>Returns a functor <code>P</code> which stores the reduced dimension <code>n</code>, the dimension of vectors to project <code>m</code>, the vectors  to project onto in the <code>m × n</code> matrix <code>M</code>, and the matrix <code>inv(M&#39;M)</code> in <code>MtMinv</code>.</p><p>Call with <code>P(b)</code> where <code>b</code> is a <code>m</code> vector or a matrix with <code>m</code> rows, projecting each column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/projections.jl#L76-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.eim_projector" href="#ModelOrderReductionToolkit.eim_projector"><code>ModelOrderReductionToolkit.eim_projector</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>P = eim_projector(A, dim)</code></p><p>Uses discrete empirical interpolation to generate a projector operator <code>P</code> that selects a few rows from the given vector or matrix, and then projects them onto a set of columns chosen by a greedy procedure.</p><p>Returns a functor <code>P</code> which stores the reduced dimension <code>n</code>, the dimension of vectors to project <code>m</code>, the matrix <code>A_C</code> which is <code>A</code> with <code>n</code> extracted columns, and the matrix <code>A_CR</code> which is <code>A</code> with <code>n</code> extracted rows and columns.</p><p>Call with <code>P(b)</code> where <code>b</code> is a <code>m</code> vector or a matrix with <code>m</code> rows, projecting each column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/projections.jl#L110-L125">source</a></section></article><h3 id="Greedy-linear-affine-reduced-basis"><a class="docs-heading-anchor" href="#Greedy-linear-affine-reduced-basis">Greedy linear affine reduced basis</a><a id="Greedy-linear-affine-reduced-basis-1"></a><a class="docs-heading-anchor-permalink" href="#Greedy-linear-affine-reduced-basis" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.Greedy_RB_Affine_Linear" href="#ModelOrderReductionToolkit.Greedy_RB_Affine_Linear"><code>ModelOrderReductionToolkit.Greedy_RB_Affine_Linear</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>Greedy_RB_Affine_Linear</code></p><p>Struct for containing initialized greedy reduced-basis method for parametrized problem A(p) u = b(p) with affine parameter dependence <code>A(p) = ∑ makeθAi(p,i) Ais[i]</code>, and <code>b(p) = ∑ makeθbi(p,i) bis[i]</code>.</p><p>Uses Galerkin projection onto span of columns of <code>V</code>,  <code>V&#39; A(p) V u_r = V&#39; b(p)</code>, with <code>V u_r ≈ u = A(p)^(-1) b(p)</code>.</p><p>Given a new parameter vector, <code>p</code>, and an object <code>greedy_sol::Greedy_RB_Affine_Linear</code>, form the reduced basis solution with <code>greedy_sol(p[, full=true])</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.GreedyRBAffineLinear" href="#ModelOrderReductionToolkit.GreedyRBAffineLinear"><code>ModelOrderReductionToolkit.GreedyRBAffineLinear</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>GreedyRBAffineLinear(param_disc, Ap, bp, approx_stability_factor, compute_res_norm, update_res_norm![, ϵ=1e-2; T=Float64, max_snapshots=-1, noise=1])</code></p><p>Constructs a <code>Greedy_RB_Affine_Linear</code> object for parametrized problem <code>Ap(p) u(p) = bp(p)</code> with affine parameter dependence given by APArrays <code>Ap</code> (matrix) and <code>bp</code> (vector)</p><p><code>param_disc</code> must either be a matrix with columns as parameters, or a vector of parameters. Uses the function <code>approx_stability_factor(p)</code> to approximate the stability factor for each parameter in the discretization, and <code>compute_res_norm(u_r,p)</code> to approximate the norm of the residual. Utilizes the affine decomposition of <code>A(p)</code>  and <code>b(p)</code> to compute upper-bounds for the error: <code>||u - V u_r|| &lt;= ||b(p) - A(p) V u_r|| / σ_min(A(p)) = compute_res_norm(u_r,p) / approx_stability_factor(p)</code>. After the parameter value with the highest upperbound error is selected, its truth solution is computed, and it is added to the reduced basis. The method <code>update_res_norm!(u)</code> is used to update the residual norm computation.</p><p>This procedure loops until the upper-bound error is less than <code>ϵ</code>, or until the number of snapshots exceeds <code>max_snapshots</code>, or the minimum of number of parameters and number of columns of <code>A</code> by default.</p><p>Specify <code>T</code> if wish to use number type other than <code>Float64</code>, works for <code>ComplexF64</code>.</p><p><code>noise</code> determines amount of printed output, <code>0</code> for no output, <code>1</code> for basic, and <code>2</code> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L204-L224">source</a></section><section><div><p><code>GreedyRBAffineLinear(param_disc, Ap, bp, approx_stability_factor[, ϵ=1e-2; res_calc=2, T=Float64, max_snapshots=-1, noise=1])</code></p><p>Constructs a <code>Greedy_RB_Affine_Linear</code> object for parametrized problem <code>Ap(p) u(p) = bp(p)</code> with affine parameter dependence given by APArrays <code>Ap</code> (matrix) and <code>bp</code> (vector).</p><p><code>param_disc</code> must either be a matrix with columns as parameters, or a vector of parameter vectors.</p><p>Uses <code>res_calc</code> to determine how the norm of the residual <code>||b(p) - A(p) V u_r||</code> is computed. By default set to <code>2</code> which uses a projection method and has online runtime independent of the dimension of <code>A</code>. If set to <code>1</code>, uses a method that also  has online runtime independent of the dimension of <code>A</code>, but may become numerically unstable for large reduced bases. If <code>0</code>, computes the residual norm explicitly which scales like <code>O(N)</code> where <code>N</code> is the dimension of <code>A</code>.</p><p>Uses the function <code>approx_stability_factor(p)</code> to approximate the stability factor for each parameter in the discretization, and the above selection to compute the norm of the residual. Utilizes the affine decomposition of <code>A(p)</code>  and <code>b(p)</code> to compute upper-bounds for the error: <code>||u - V u_r|| &lt;= ||b(p) - A(p) V u_r|| / σ_min(A(p)) = compute_res_norm(u_r,p) / approx_stability_factor(p)</code>. After the parameter value with the highest upperbound error is selected, its truth solution is computed, and it is added to the reduced basis. The method <code>update_res_norm!(u)</code> is used to update the residual norm computation.</p><p>This procedure loops until the upper-bound error is less than <code>ϵ</code>, or until the number of snapshots exceeds <code>max_snapshots</code>, or the minimum of number of parameters and number of columns of <code>A</code> by default.</p><p>Specify <code>T</code> if wish to use number type other than <code>Float64</code>, works for <code>ComplexF64</code>.</p><p><code>noise</code> determines amount of printed output, <code>0</code> for no output, <code>1</code> for basic, and <code>2</code> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L296-L322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.greedy_rb_err_data" href="#ModelOrderReductionToolkit.greedy_rb_err_data"><code>ModelOrderReductionToolkit.greedy_rb_err_data</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>greedy_rb_err_data(param_disc,Ap,bp,approx_stability_factor[,num_snapshots=10,ϵ=1e-2;noise=1)</code></p><p>Constructs a <code>Greedy_RB_Affine_Linear</code> object for parametrized problem <code>Ap(p) u(p) = bp(p)</code> with affine parameter dependence given by APArrays <code>Ap</code> (matrix) and <code>bp</code> (vector).</p><p><strong>Note</strong>: This method calls the full order solver on all parameters in <code>param_disc</code>, may take a long time to run.</p><p>See the docs for <code>GreedyRBAffineLinear</code> for more information.</p><p>Returns a dictionary, <code>ret_data</code>, with the following components:</p><p><code>ret_data[:truth_sols]</code> = Vector containing all truth solutions.</p><p><code>ret_data[:basis_dim]</code> - A vector of reduced basis dimensions from 2 to <code>num_snapshots</code></p><p><code>ret_data[:weak_greedy_ub]</code> - A vector of the maximum upperbound l2 error found by the  (weak) greedy reduced basis method (see <code>GreedyRBAffineLinear</code>)</p><p><code>ret_data[:weak_greedy_true]</code> - A vector of the truth l2 error of the vector chosen by the  (weak) greedy reduced basis method (see <code>GreedyRBAffineLinear</code>)</p><p><code>ret_data[:weak_greedy_true_ub]</code> - A vector of the maximum true l2 error found by the  (weak) greedy reduced basis method (see <code>GreedyRBAffineLinear</code>)</p><p><code>ret_data[:strong_greedy_err]</code> - A vector of the maximum l2 error found by a   strong greedy reduced basis method, uses knowledge of all solutions</p><p><code>ret_data[:strong_greedy_proj]</code> - A vector of the maximum l2 error found by projecting   truth solutions onto the strong greedy reduced basis, uses knowledge of all solutions</p><p><code>ret_data[:qr_projector]</code> - A projection object which can be used to orthogonally project vectors onto the strong greedy subspace. See ModelOrderReductionToolkit.qr_projector method.</p><p><code>ret_data[:pca_err]</code> - A vector of the maximum l2 error found by a PCA/POD reduced basis method, uses knowledge of all solutions</p><p><code>ret_data[:strong_greedy_proj]</code> - A vector of the maximum l2 error found by projecting   truth solutions onto the PCA/POD reduced basis, uses knowledge of all solutions</p><p><code>ret_data[:pca_projector]</code> - A projection object which can be used to orthogonally project vectors onto the SVD/PCA subspace. See ModelOrderReductionToolkit.pca_projector method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L397-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.append_affine_rbm!" href="#ModelOrderReductionToolkit.append_affine_rbm!"><code>ModelOrderReductionToolkit.append_affine_rbm!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>append_affine_rbm!(greedy_sol, x)</code></p><p>Given a <code>Greedy_RB_Affine_Linear</code> object, <code>greedy_sol</code>, and a new  vector <code>x</code>, update the vectors and matrices in <code>greedy_sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.init_affine_rbm" href="#ModelOrderReductionToolkit.init_affine_rbm"><code>ModelOrderReductionToolkit.init_affine_rbm</code></a> — <span class="docstring-category">Function</span></header><section><div><p>TODO Update header <code>init_affine_rbm(x, Ais, bis, makeθAi, makeθbi, T)</code></p><p>Given a vector <code>x</code>, generates the matrices <code>V</code> and <code>VtAVis</code>, and the vectors <code>Vtbis</code> for preallocation and quick computation of reduced basis solutions for the problem <code>A(p)x(p)=b(p)</code> with affinely dependent matrix <code>A(p) = ∑ makeθAi(p,i) Ais[i]</code> and vector <code>b(p) = ∑ makeθbi(p,i) bis[i]</code>. Must pass in type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/greedy_linear_rb.jl#L82-L91">source</a></section></article><h3 id="Successive-constraint-method-(SCM):"><a class="docs-heading-anchor" href="#Successive-constraint-method-(SCM):">Successive constraint method (SCM):</a><a id="Successive-constraint-method-(SCM):-1"></a><a class="docs-heading-anchor-permalink" href="#Successive-constraint-method-(SCM):" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.SCM_Init" href="#ModelOrderReductionToolkit.SCM_Init"><code>ModelOrderReductionToolkit.SCM_Init</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>SCM_Init</code> is a struct for holding all of the variables and methods necessary for running the successive constraint method on an affinely-parameter-dependent matrix <code>A(p) = ∑_{i=1}^QA θ_i(p) A_i</code> to compute a lower-bound approximation to the minimum singular value of <code>A</code>.</p><p>It is additionally a functor as calling <code>scm_init(p)</code> on a parameter vector <code>p</code> will return the lower-bound estimate of the minimum singular value of <code>A(p)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/successive_constraint.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.initialize_SCM_SPD" href="#ModelOrderReductionToolkit.initialize_SCM_SPD"><code>ModelOrderReductionToolkit.initialize_SCM_SPD</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>initialize_SCM_SPD(param_disc,Ap,Mα,Mp,ϵ;[T=Float64,optimizer=Tulip.Optimizer,kmaxiter=1000,noise=1,lp_attrs]) = SCM_Init</code></p><p>Method to initialize an <code>SCM_Init</code> object to perform the SCM on an affinely-parameter-dependent symmetric positive definite matrix <code>Ap&lt;:APArray</code> to compute a lower-bound approximation to the minimum  singular value (stability factor) of <code>A(p)</code>.</p><p>If wish to use complex matrices, pass in <code>T=ComplexF64</code>, however, affine coefficients must be real.</p><p>Parameters:</p><p><code>param_disc</code>: Either a matrix where each column is a parameter value in the discretization, or a vector of parameter vectors.</p><p><code>Ap</code>: APArray object that stores the affine parameter dependence of the matrix <code>A(p) = ∑ makeθAi(p,i) Ais[i]</code></p><p><code>Mα</code>: Stability constraint constant (a positive integer)</p><p><code>Mp</code>: Positivity constraint constant (a positive integer)</p><p><code>ϵ</code>: Relative difference allowed between upper-bound and lower-bound approximation on the parameter discretization (between 0 and 1)</p><p><code>T</code>: Datatype for matrix initialization, default <code>Float64</code>. If using  complex matrices, pass <code>T=ComplexF64</code>.</p><p><code>kmaxiter</code>: Maximum number of iterations used in iterating eigensolver before defaulting to full-dense eigensolve.</p><p><code>noise</code>: Determines amount of printed information, between 0 and 2 with 0 being nothing displayed; default 1.</p><p><code>lp_attrs</code>: A dicitonary of attributes to set for the linear program with the given optimizer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/successive_constraint.jl#L67-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.initialize_SCM_Noncoercive" href="#ModelOrderReductionToolkit.initialize_SCM_Noncoercive"><code>ModelOrderReductionToolkit.initialize_SCM_Noncoercive</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>initialize_SCM_Noncoercive(param_disc,Ap,Mα,Mp,ϵ;[T=Float64,optimizer=Tulip.Optimizer,kmaxiter=1000,noise=1,lp_attrs]) = SCM_Init</code></p><p>Method to initialize an <code>SCM_Init</code> object to perform the SCM on an affinely-parameter-dependent matrix <code>A(p) = ∑ makeθAi(p,i) Ais[i]</code> to compute a lower-bound approximation to the minimum singular value (stability factor) of <code>A(p)</code>.</p><p>If wish to use complex matrices, pass in <code>T=ComplexF64</code>, however, affine coefficients must be real.</p><p>Parameters:</p><p><code>param_disc</code>: Either a matrix where each column is a parameter value in the discretization, or a vector of parameter vectors.</p><p><code>Ap</code>: <code>APArray</code> object to hold information for affine  parameter dependence of matrix <code>A(p)</code>. </p><p><code>Mα</code>: Stability constraint constant (a positive integer)</p><p><code>Mp</code>: Positivity constraint constant (a positive integer)</p><p><code>ϵ</code>: Relative difference allowed between upper-bound and lower-bound approximation on the parameter discretization (between 0 and 1)</p><p><code>T</code>: Datatype for matrix initialization, default <code>Float64</code>. If using  complex matrices, pass <code>T=ComplexF64</code>.</p><p><code>kmaxiter</code>: Maximum number of iterations used in iterating eigensolver before defaulting to full-dense eigensolve.</p><p><code>noise</code>: Determines amount of printed information, between 0 and 2 with 0 being nothing displayed; default 1.</p><p><code>lp_attrs</code>: A dicitonary of attributes to set for the linear program with the given optimizer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/successive_constraint.jl#L207-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.find_sigma_bounds" href="#ModelOrderReductionToolkit.find_sigma_bounds"><code>ModelOrderReductionToolkit.find_sigma_bounds</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>find_sigma_bounds(scm_init, p[, sigma_eps=1.0; noise=0])</code></p><p>Method that performs the online phase of SCM for the matrix <code>A(p) = ∑ makeθAi(p,i) Ais[i]</code> to compute lower and upper-bound approximations to the minimum singular value of <code>A</code>. Additional optional parameter <code>sigma_eps</code> such that if the computed ϵ difference of <code>(σ_UB - σ_LB) / σ_UB</code> is less than <code>sigma_eps</code>,  we know that not enough stability constraints were enforced, and  the minimum singular value is directly computed, appended to the  scm_init&#39;s upper-bound set, and returned as both the lower and upper-bounds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/successive_constraint.jl#L522-L533">source</a></section></article><h3 id="Radial-basis-interpolatory-stability-factor"><a class="docs-heading-anchor" href="#Radial-basis-interpolatory-stability-factor">Radial-basis interpolatory stability factor</a><a id="Radial-basis-interpolatory-stability-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Radial-basis-interpolatory-stability-factor" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.Sigma_Min_RBF" href="#ModelOrderReductionToolkit.Sigma_Min_RBF"><code>ModelOrderReductionToolkit.Sigma_Min_RBF</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>Sigma_Min_RBF</code></p><p>A mutable struct used for approximating the minimum singular value of a matrix  with parametric dependence <code>A(p)</code>. Given  a new parameter value <code>p</code>, approximate <code>σ_min(A(p))</code> with <code>sigma_min_rbf(p)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/stability_radial_basis.jl#L8-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.min_sigma_rbf" href="#ModelOrderReductionToolkit.min_sigma_rbf"><code>ModelOrderReductionToolkit.min_sigma_rbf</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>min_sigma_rbf(params, Ais, makeθAi[, ϕ=gaussian_rbf])</code></p><p>Method to form a interpolatory radial-basis function functor to approximate the minimum singular value of a parametrized matrix <code>A(p)</code>. Pass as input either a matrix <code>params</code> where each column is a parameter vector, or a vector  of vectors <code>params</code> where each vector is a parameter. </p><p>Optional argument for the radial-basis function <code>ϕ</code>, which defaults to the Gaussian <code>ϕ(r) = exp(-r^2)</code>.</p><p>Returns a functor <code>sigma_min_rbf &lt;: Sigma_Min_RBF</code> such that given a new parameter vector <code>p</code>, <code>sigma_min_rbf(p)</code> returns an approximation to the minimum singular value of <code>A(p)</code>.</p><p>Offline, solves for the minimum singular value for each parameter in <code>params</code>, and uses this to form an interpolatory approximation in the form of <code>log(σ_min(A(p))) ≈ ω_0 + ∑ (ω_i p_i) + ∑ (γ_i ϕ(p - p_i))</code> where <code>p_i</code> is the i&#39;th parameter in <code>params</code>, and <code>ω_0</code>, <code>ω_i</code>, and <code>γ_i</code> are determined by the given <code>params</code> such that the approximation holds true for all <code>p_i</code>, and that <code>∑ γ_i = 0</code>, and that <code>∑ γ_i p_i[j] = 0</code> for each <code>j</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/stability_radial_basis.jl#L38-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.update_sigma_rbf!" href="#ModelOrderReductionToolkit.update_sigma_rbf!"><code>ModelOrderReductionToolkit.update_sigma_rbf!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>update_sigma_rbf!(sigma_min_rbf, ϕ)</code></p><p>Given a <code>Sigma_Min_RBF</code> object <code>sigma_min_rbf</code>, update its RBF, <code>ϕ</code>, and update the coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/stability_radial_basis.jl#L127-L132">source</a></section></article><h3 id="Computation-of-norm-of-residual"><a class="docs-heading-anchor" href="#Computation-of-norm-of-residual">Computation of norm of residual</a><a id="Computation-of-norm-of-residual-1"></a><a class="docs-heading-anchor-permalink" href="#Computation-of-norm-of-residual" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.Affine_Residual_Init_Proj" href="#ModelOrderReductionToolkit.Affine_Residual_Init_Proj"><code>ModelOrderReductionToolkit.Affine_Residual_Init_Proj</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>Affine_Residual_Init_Proj</code></p><p>A struct for containing the necessary vectors and matrices for quickly compute the <code>X</code>-norm of the residual, <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Here, <code>u</code> solves <code>A(p) u = b(p)</code> with <code>A</code> and <code>b</code> having affine parameter dependence, and <code>V</code> is a matrix with columns defining bases for approximation spaces <code>u ≈ V u_r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L205-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.Affine_Residual_Init" href="#ModelOrderReductionToolkit.Affine_Residual_Init"><code>ModelOrderReductionToolkit.Affine_Residual_Init</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>Affine_Residual_Init</code></p><p>A struct for containing the necessary vectors and matrices for quickly compute the <code>X</code>-norm of the residual, <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Here, <code>u</code> solves <code>A(p) u = b(p)</code> with <code>A</code> and <code>b</code> having affine parameter dependence, and <code>V</code> is a matrix with columns defining bases for approximation spaces <code>u ≈ V u_r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.residual_norm_affine_proj_init" href="#ModelOrderReductionToolkit.residual_norm_affine_proj_init"><code>ModelOrderReductionToolkit.residual_norm_affine_proj_init</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>residual_norm_affine_init(Ais, makeθAi, bis, makeθbi, V[, X=nothing, T=Float64])</code></p><p>Method that constructs the necessary vectors and matrices to quickly compute the <code>X</code>-norm of the residual,  <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Does this in a more numerically stable way by computing the projections of <code>b(p)</code> onto the span of the columns of  <code>A(p) V</code>, so no negative cross-term needs to be evaluated.</p><p>Pass as input a vector of matrices <code>Ais</code>, and a function <code>makeθAi</code> such that the affine construction of <code>A</code> is given by <code>A(p) = ∑_{i=1}^QA makeθAi(p,i) * Ais[i]</code>, and similarly a vector of vectors <code>bis</code> and a function <code>makeθbi</code> such that the affine construction of <code>b</code> is given by  <code>b(p) = ∑_{i=1}^Qb makeθbi(p,i) * bis[i]</code>.</p><p>Additionally, pass in a matrix <code>V</code> which contains as columns a basis for a reduced space, <code>u ≈ V u_r</code> with the dimension of <code>u_r</code> less than that of <code>u</code>.</p><p>Optionally pass in a matrix <code>X</code> from which the <code>X</code>-norm of the residual will be computed in the method <code>residual_norm_affine_online</code>. If <code>X</code> remains as <code>nothing</code>, then will choose it to be the identity matrix to compute the 2-norm of the residual. (NOT YET IMPLEMENTED)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L233-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.residual_norm_affine_init" href="#ModelOrderReductionToolkit.residual_norm_affine_init"><code>ModelOrderReductionToolkit.residual_norm_affine_init</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>residual_norm_affine_init(Ais, makeθAi, bis, makeθbi, V[, X=nothing])</code></p><p>Method that constructs the necessary vectors and matrices to quickly compute the <code>X</code>-norm of the residual,  <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Pass as input a vector of matrices <code>Ais</code>, and a function <code>makeθAi</code> such that the affine construction of <code>A</code> is given by <code>A(p) = ∑_{i=1}^QA makeθAi(p,i) * Ais[i]</code>, and similarly a vector of vectors <code>bis</code> and a function <code>makeθbi</code> such that the affine construction of <code>b</code> is given by  <code>b(p) = ∑_{i=1}^Qb makeθbi(p,i) * bis[i]</code>.</p><p>Additionally, pass in a matrix <code>V</code> which contains as columns a basis for a reduced space, <code>u ≈ V u_r</code> with the dimension of <code>u_r</code> less than that of <code>u</code>.</p><p>Optionally pass in a matrix <code>X</code> from which the <code>X</code>-norm of the residual will be computed in the method <code>residual_norm_affine_online</code>. If <code>X</code> remains as <code>nothing</code>, then will choose it to be the identity matrix to compute the 2-norm of the residual. (NOT YET IMPLEMENTED)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L27-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.add_col_to_V!" href="#ModelOrderReductionToolkit.add_col_to_V!"><code>ModelOrderReductionToolkit.add_col_to_V!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>add_col_to_V!(res_init, v)</code></p><p>Method to add a vector <code>v</code> to the columns of the matrix <code>V</code> in the <code>Affine_Residual_Init</code> object, <code>res_init</code>, without recomputing all terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L102-L108">source</a></section><section><div><p><code>add_col_to_V!(res_init, v)</code></p><p>Method to add a vector <code>v</code> to the columns of the matrix <code>V</code> in the <code>Affine_Residual_Init_Proj</code> object, <code>res_init</code>, without recomputing all terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L332-L338">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.residual_norm_affine_online" href="#ModelOrderReductionToolkit.residual_norm_affine_online"><code>ModelOrderReductionToolkit.residual_norm_affine_online</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>residual_norm_affine_online(res_init, u_r, p)</code></p><p>Method that given <code>res_init</code>, an <code>Affine_Residual_Init</code> object, computes the <code>X</code>-norm of the residual,  <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Pass as input the <code>Affine_Residual_Init</code> object, <code>res_init</code>, a reduced vector <code>u_r</code>, and the corresponding parameter vector <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L147-L159">source</a></section><section><div><p><code>residual_norm_affine_online(res_init, u_r, p)</code></p><p>Method that given <code>res_init</code>, an <code>Affine_Residual_Init_Proj</code> object, computes the 2-norm of the residual,  <code>r(u_r,p) = A(p) (u - V u_r) = b(p) - A(p) V u_r</code>, by taking advantage of affine parameter dependence of <code>A(p)</code> and <code>b(p)</code>.</p><p>Does this in a more numerically stable way by computing the projections of <code>b(p)</code> onto the span of the columns of  <code>A(p) V</code>, so no negative cross-term needs to be evaluated.</p><p>Pass as input the <code>Affine_Residual_Init</code> object, <code>res_init</code>, a reduced vector <code>u_r</code>, and the corresponding parameter vector <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/residual_norm.jl#L389-L405">source</a></section></article><h3 id="Linear-algebra-utilities"><a class="docs-heading-anchor" href="#Linear-algebra-utilities">Linear algebra utilities</a><a id="Linear-algebra-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-algebra-utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.full_lu" href="#ModelOrderReductionToolkit.full_lu"><code>ModelOrderReductionToolkit.full_lu</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>full_lu(A; steps=-1)</code></p><p>Performs a completely pivoted LU factorization on the matrix <code>A</code>, returning permutation vectors <code>Q</code> and <code>P</code>, and lower and upper triangular matrices <code>L</code> and <code>U</code>, such that if all steps are performed, then <code>A[P,Q] = L*U</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.smallest_real_eigval" href="#ModelOrderReductionToolkit.smallest_real_eigval"><code>ModelOrderReductionToolkit.smallest_real_eigval</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>smallest_real_eigval(A, kmaxiter[, noise=1, krylovsteps=10])</code></p><p>Given a hermitian matrix <code>A</code>, attempts to compute the  most negative (real) eigenvalue. First, uses Krylov iteration with a shift-invert procedure with Gershgorin disks, and if  not successful, calls a full, dense, eigensolve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L55-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.largest_real_eigval" href="#ModelOrderReductionToolkit.largest_real_eigval"><code>ModelOrderReductionToolkit.largest_real_eigval</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>largest_real_eigval(A, kmaxiter[, noise=1])</code></p><p>Given a hermitian matrix <code>A</code>, attempts to compute the  most positive (real) eigenvalue. First, uses Krylov iteration with no shift-invert, and if not successful, calls a full,  dense, eigensolve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L100-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.smallest_real_pos_eigpair" href="#ModelOrderReductionToolkit.smallest_real_pos_eigpair"><code>ModelOrderReductionToolkit.smallest_real_pos_eigpair</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>smallest_real_pos_eigpair(A, kmaxiter[, noise=1])</code></p><p>Given a hermitian, positive definite matrix <code>A</code>, attempts to compute the  smallest (real) eigenvalue and eigenvector. First, uses Krylov iteration with shift-invert around zero, and if not successful, calls a full,  dense, eigensolve. Returns a tuple with the first component being the  eigenvalue, and the second component being the eigenvector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L126-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.smallest_sval" href="#ModelOrderReductionToolkit.smallest_sval"><code>ModelOrderReductionToolkit.smallest_sval</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>smallest_sval(A, kmaxiter[, noise=1])</code></p><p>Given a matrix <code>A</code>, attempts to compute the smallest singular value of it by Krylov iteration and inversion around 0. If unsuccessful, computes a full, dense svd.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L153-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelOrderReductionToolkit.orthonormalize_mgs2!" href="#ModelOrderReductionToolkit.orthonormalize_mgs2!"><code>ModelOrderReductionToolkit.orthonormalize_mgs2!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>orthonormalize_mgs2!(u, V)</code></p><p>Given a matrix <code>V</code>, and a new vector <code>u</code>, orthogonalize <code>u</code>  with respect to the columns of <code>V</code>, and computes its norm <code>nu</code>. If <code>nu != 0</code>, divides <code>u</code> by <code>nu</code> and returns  <code>nu</code>. If <code>nu == 0</code>, then <code>u</code> lives in the span of <code>V</code>, and <code>0</code> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/ModelOrderReductionToolkit.jl/blob/5683caaba6de424e90dbba968ad0cd5ef5ce8ed5/src/la_utils.jl#L179-L187">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="test_prob.html">Test Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 3 July 2024 17:59">Wednesday 3 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
